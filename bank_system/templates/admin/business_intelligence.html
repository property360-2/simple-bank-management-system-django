{% extends 'admin/base.html' %}

{% block title %}Business Intelligence{% endblock %}

{% block content %}
<div class="admin-header">
    <h1><i class="fas fa-brain me-2"></i>Business Intelligence & Forecasting</h1>
    <p>Advanced analytics with SARIMA time series forecasting and descriptive statistics</p>
</div>

<div class="container-fluid px-4 pb-4">
    <!-- Transaction Descriptive Analytics -->
    <h4 class="mb-3 mt-5"><i class="fas fa-calculator me-2"></i>Descriptive Analytics</h4>
    <div class="row g-4 mb-4">
        <!-- Transaction Statistics -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-exchange-alt me-2"></i>Transaction Statistics
                    </h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-dark mb-0">
                        <tbody>
                            {% if transaction_analytics %}
                                <tr>
                                    <td><strong>Total Transactions</strong></td>
                                    <td>{{ transaction_analytics.count }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Mean Amount</strong></td>
                                    <td>${{ transaction_analytics.mean|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Median Amount</strong></td>
                                    <td>${{ transaction_analytics.median|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Standard Deviation</strong></td>
                                    <td>${{ transaction_analytics.std_dev|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Minimum Amount</strong></td>
                                    <td>${{ transaction_analytics.min|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Maximum Amount</strong></td>
                                    <td>${{ transaction_analytics.max|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>25th Percentile</strong></td>
                                    <td>${{ transaction_analytics.q25|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>75th Percentile</strong></td>
                                    <td>${{ transaction_analytics.q75|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Skewness</strong></td>
                                    <td>{{ transaction_analytics.skewness|floatformat:3 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Kurtosis</strong></td>
                                    <td>{{ transaction_analytics.kurtosis|floatformat:3 }}</td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="2" class="text-center text-muted">No transaction data available</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Account Balance Statistics -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-wallet me-2"></i>Account Balance Statistics
                    </h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-dark mb-0">
                        <tbody>
                            {% if account_analytics %}
                                <tr>
                                    <td><strong>Total Balance</strong></td>
                                    <td>${{ account_analytics.total_balance|floatformat:0 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Average Balance</strong></td>
                                    <td>${{ account_analytics.average_balance|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Median Balance</strong></td>
                                    <td>${{ account_analytics.median_balance|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Standard Deviation</strong></td>
                                    <td>${{ account_analytics.std_dev|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Minimum Balance</strong></td>
                                    <td>${{ account_analytics.min_balance|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Maximum Balance</strong></td>
                                    <td>${{ account_analytics.max_balance|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>25th Percentile</strong></td>
                                    <td>${{ account_analytics.percentile_25|floatformat:2 }}</td>
                                </tr>
                                <tr>
                                    <td><strong>75th Percentile</strong></td>
                                    <td>${{ account_analytics.percentile_75|floatformat:2 }}</td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="2" class="text-center text-muted">No account data available</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- User Activity Analytics -->
    <div class="row mb-4">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-users me-2"></i>User Activity Analytics
                    </h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-dark mb-0">
                        <tbody>
                            {% if user_analytics %}
                                <tr>
                                    <td><strong>Total Users</strong></td>
                                    <td>{{ user_analytics.total_users }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Active Users (Ever Logged In)</strong></td>
                                    <td>{{ user_analytics.active_users }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Active Last 30 Days</strong></td>
                                    <td>{{ user_analytics.active_last_month }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Activity Rate</strong></td>
                                    <td>{{ user_analytics.activity_rate|floatformat:1 }}%</td>
                                </tr>
                                <tr>
                                    <td><strong>Avg Transactions per User</strong></td>
                                    <td>{{ user_analytics.avg_transactions_per_user|floatformat:2 }}</td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="2" class="text-center text-muted">No user data available</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>


{% endblock %}
